/**
 * Compatibility CSS - Fallbacks for Older Browsers
 * 
 * This file provides RGB/HSL fallbacks for modern OKLCH colors
 * to ensure the site works on older browsers and restricted networks.
 * 
 * Browser Support:
 * - OKLCH: Chrome 111+, Safari 15.4+, Firefox 113+ (2023+)
 * - These fallbacks support: Chrome 60+, Safari 12+, Firefox 60+ (2018+)
 */

/* ========================================
   TAILWIND GRADIENT UTILITY FALLBACKS
   ======================================== */
/* These rules provide explicit fallbacks for Tailwind's gradient utilities
   when they use CSS variables that contain OKLCH colors */

.no-oklch .bg-gradient-to-r.from-primary {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary.to-accent {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36)
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary.via-accent {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36),
    var(--tw-gradient-to, rgba(251, 191, 36, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary.via-accent.to-primary {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36),
    rgb(234, 179, 8)
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-primary {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-primary.via-primary\/90 {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    rgba(234, 179, 8, 0.9),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-primary.via-primary\/90.to-primary\/80 {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    rgba(234, 179, 8, 0.9),
    rgba(234, 179, 8, 0.8)
  ) !important;
}

.no-oklch .bg-gradient-to-tl.from-primary\/20 {
  background: linear-gradient(
    to top left,
    rgba(234, 179, 8, 0.2),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-tl.from-primary\/20.to-accent\/20 {
  background: linear-gradient(
    to top left,
    rgba(234, 179, 8, 0.2),
    rgba(251, 191, 36, 0.2)
  ) !important;
}

/* Text gradient fallback - for bg-clip-text */
.no-oklch
  .bg-clip-text.text-transparent.bg-gradient-to-r.from-primary.via-accent.to-primary {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36),
    rgb(234, 179, 8)
  ) !important;
  -webkit-background-clip: text !important;
  background-clip: text !important;
  color: transparent !important;
}

/* Fallback for browsers without bg-clip-text support */
@supports not (background-clip: text) {
  .bg-clip-text.text-transparent {
    color: rgb(234, 179, 8) !important;
    background: none !important;
  }
}

/* Additional gradient patterns */
.no-oklch .bg-gradient-to-br.from-primary.to-accent {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    rgb(251, 191, 36)
  ) !important;
}

.no-oklch .bg-gradient-to-b.from-background {
  background: linear-gradient(
    to bottom,
    rgb(255, 255, 255),
    var(--tw-gradient-to, rgba(255, 255, 255, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-primary\/5 {
  background: linear-gradient(
    to bottom right,
    rgba(234, 179, 8, 0.05),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-primary\/5.via-background.to-accent\/10 {
  background: linear-gradient(
    to bottom right,
    rgba(234, 179, 8, 0.05),
    rgb(255, 255, 255),
    rgba(251, 191, 36, 0.1)
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary\/10 {
  background: linear-gradient(
    to right,
    rgba(234, 179, 8, 0.1),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary\/10.to-accent\/10 {
  background: linear-gradient(
    to right,
    rgba(234, 179, 8, 0.1),
    rgba(251, 191, 36, 0.1)
  ) !important;
}

.no-oklch .bg-gradient-to-r.from-primary\/10.via-accent\/10.to-primary\/10 {
  background: linear-gradient(
    to right,
    rgba(234, 179, 8, 0.1),
    rgba(251, 191, 36, 0.1),
    rgba(234, 179, 8, 0.1)
  ) !important;
}

/* Category filter buttons */
.no-oklch button.bg-gradient-to-r.from-primary.to-accent {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36)
  ) !important;
}

/* Hover state fallbacks */
.no-oklch
  .bg-gradient-to-r.from-primary.to-accent.hover\:from-primary\/90:hover,
.no-oklch .bg-gradient-to-r.from-primary.to-accent:hover {
  background: linear-gradient(
    to right,
    rgba(234, 179, 8, 0.9),
    rgba(251, 191, 36, 0.9)
  ) !important;
}

.no-oklch
  .bg-gradient-to-br.from-primary.to-accent.hover\:from-primary\/90:hover,
.no-oklch .bg-gradient-to-br.from-primary.to-accent:hover {
  background: linear-gradient(
    to bottom right,
    rgba(234, 179, 8, 0.9),
    rgba(251, 191, 36, 0.9)
  ) !important;
}

/* Background color gradients with opacity */
.no-oklch .bg-gradient-to-b.from-background\/40 {
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.4),
    var(--tw-gradient-to, rgba(255, 255, 255, 0))
  ) !important;
}

.no-oklch .bg-gradient-to-b.from-background\/40.via-background\/60 {
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.4),
    rgba(255, 255, 255, 0.6),
    var(--tw-gradient-to, rgba(255, 255, 255, 0))
  ) !important;
}

.no-oklch
  .bg-gradient-to-b.from-background\/40.via-background\/60.to-background\/90 {
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.4),
    rgba(255, 255, 255, 0.6),
    rgba(255, 255, 255, 0.9)
  ) !important;
}

.no-oklch .bg-gradient-to-b.from-background.to-muted\/50 {
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0),
    rgba(245, 245, 245, 0.5)
  ) !important;
}

/* Specific fallback for questions section to ensure animated lights show through */
.no-oklch section#questions-section {
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0),
    rgba(245, 245, 245, 0.5)
  ) !important;
}

/* Dark mode background gradients */
.dark
  .no-oklch
  .bg-gradient-to-b.from-background\/40.via-background\/60.to-background\/90 {
  background: linear-gradient(
    to bottom,
    rgba(10, 10, 10, 0.4),
    rgba(10, 10, 10, 0.6),
    rgba(10, 10, 10, 0.9)
  ) !important;
}

.dark .no-oklch .bg-gradient-to-b.from-background.to-muted\/50 {
  background: linear-gradient(
    to bottom,
    rgb(10, 10, 10),
    rgba(23, 23, 23, 0.5)
  ) !important;
}

/* InstallPrompt hardcoded OKLCH fallbacks */
.no-oklch .bg-gradient-to-br.from-\[oklch\(0\.25_0\.1_240\)\] {
  background: linear-gradient(
    to bottom right,
    rgb(23, 23, 50),
    var(--tw-gradient-to, rgba(23, 23, 50, 0))
  ) !important;
}

.no-oklch
  .bg-gradient-to-br.from-\[oklch\(0\.25_0\.1_240\)\].to-\[oklch\(0\.15_0\.1_240\)\] {
  background: linear-gradient(
    to bottom right,
    rgb(23, 23, 50),
    rgb(12, 12, 25)
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-\[oklch\(0\.75_0\.15_85\)\] {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    var(--tw-gradient-to, rgba(234, 179, 8, 0))
  ) !important;
}

.no-oklch
  .bg-gradient-to-br.from-\[oklch\(0\.75_0\.15_85\)\].to-\[oklch\(0\.85_0\.18_90\)\] {
  background: linear-gradient(
    to bottom right,
    rgb(234, 179, 8),
    rgb(251, 191, 36)
  ) !important;
}

.no-oklch .bg-gradient-to-br.from-\[oklch\(0\.75_0\.15_85\)\]\/10 {
  background: linear-gradient(
    to bottom right,
    rgba(234, 179, 8, 0.1),
    transparent
  ) !important;
}

.no-oklch
  .bg-gradient-to-r.from-\[oklch\(0\.75_0\.15_85\)\].to-\[oklch\(0\.85_0\.18_90\)\] {
  background: linear-gradient(
    to right,
    rgb(234, 179, 8),
    rgb(251, 191, 36)
  ) !important;
}

/* ========================================
   BASE COLOR VARIABLE FALLBACKS
   ======================================== */

/* Root fallbacks for light mode */
:root {
  /* Background colors - RGB fallbacks */
  --background: rgb(255, 255, 255);
  --foreground: rgb(10, 10, 10);

  /* Card colors */
  --card: rgb(255, 255, 255);
  --card-foreground: rgb(10, 10, 10);

  /* Popover colors */
  --popover: rgb(255, 255, 255);
  --popover-foreground: rgb(10, 10, 10);

  /* Primary colors - Yellow/Gold theme */
  --primary: rgb(20, 20, 20);
  --primary-foreground: rgb(250, 250, 250);

  /* Secondary colors */
  --secondary: rgb(245, 245, 245);
  --secondary-foreground: rgb(20, 20, 20);

  /* Muted colors */
  --muted: rgb(245, 245, 245);
  --muted-foreground: rgb(115, 115, 115);

  /* Accent colors */
  --accent: rgb(245, 245, 245);
  --accent-foreground: rgb(20, 20, 20);

  /* Destructive colors */
  --destructive: rgb(239, 68, 68);
  --destructive-foreground: rgb(250, 250, 250);

  /* Border and input colors */
  --border: rgb(229, 229, 229);
  --input: rgb(229, 229, 229);
  --ring: rgb(163, 163, 163);

  /* Chart colors */
  --chart-1: rgb(234, 179, 8);
  --chart-2: rgb(59, 130, 246);
  --chart-3: rgb(139, 92, 246);
  --chart-4: rgb(251, 191, 36);
  --chart-5: rgb(250, 204, 21);

  /* Sidebar colors */
  --sidebar: rgb(250, 250, 250);
  --sidebar-foreground: rgb(10, 10, 10);
  --sidebar-primary: rgb(20, 20, 20);
  --sidebar-primary-foreground: rgb(250, 250, 250);
  --sidebar-accent: rgb(245, 245, 245);
  --sidebar-accent-foreground: rgb(20, 20, 20);
  --sidebar-border: rgb(229, 229, 229);
  --sidebar-ring: rgb(163, 163, 163);

  /* Modern browsers will override with OKLCH */
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

/* Dark mode fallbacks */
.dark {
  /* Background colors - RGB fallbacks */
  --background: rgb(10, 10, 10);
  --foreground: rgb(250, 250, 250);

  /* Card colors */
  --card: rgb(20, 20, 20);
  --card-foreground: rgb(250, 250, 250);

  /* Popover colors */
  --popover: rgb(20, 20, 20);
  --popover-foreground: rgb(250, 250, 250);

  /* Primary colors */
  --primary: rgb(229, 229, 229);
  --primary-foreground: rgb(20, 20, 20);

  /* Secondary colors */
  --secondary: rgb(38, 38, 38);
  --secondary-foreground: rgb(250, 250, 250);

  /* Muted colors */
  --muted: rgb(38, 38, 38);
  --muted-foreground: rgb(163, 163, 163);

  /* Accent colors */
  --accent: rgb(38, 38, 38);
  --accent-foreground: rgb(250, 250, 250);

  /* Destructive colors */
  --destructive: rgb(248, 113, 113);
  --destructive-foreground: rgb(250, 250, 250);

  /* Border and input colors */
  --border: rgba(255, 255, 255, 0.1);
  --input: rgba(255, 255, 255, 0.15);
  --ring: rgb(115, 115, 115);

  /* Chart colors */
  --chart-1: rgb(139, 92, 246);
  --chart-2: rgb(74, 222, 128);
  --chart-3: rgb(250, 204, 21);
  --chart-4: rgb(244, 114, 182);
  --chart-5: rgb(251, 146, 60);

  /* Sidebar colors */
  --sidebar: rgb(20, 20, 20);
  --sidebar-foreground: rgb(250, 250, 250);
  --sidebar-primary: rgb(139, 92, 246);
  --sidebar-primary-foreground: rgb(250, 250, 250);
  --sidebar-accent: rgb(38, 38, 38);
  --sidebar-accent-foreground: rgb(250, 250, 250);
  --sidebar-border: rgba(255, 255, 255, 0.1);
  --sidebar-ring: rgb(115, 115, 115);

  /* Modern browsers will override with OKLCH */
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

/* index.css fallbacks - Dark blue theme for game */
:root {
  /* RGB fallbacks for index.css colors */
  --background: rgb(26, 31, 61);
  --foreground: rgb(250, 250, 250);
  --card: rgb(38, 46, 78);
  --card-foreground: rgb(250, 250, 250);
  --popover: rgb(38, 46, 78);
  --popover-foreground: rgb(250, 250, 250);
  --primary: rgb(234, 179, 8);
  --primary-foreground: rgb(26, 31, 61);
  --secondary: rgb(72, 85, 142);
  --secondary-foreground: rgb(250, 250, 250);
  --muted: rgb(51, 61, 102);
  --muted-foreground: rgb(200, 205, 224);
  --accent: rgb(251, 191, 36);
  --accent-foreground: rgb(26, 31, 61);
  --destructive: rgb(220, 79, 79);
  --destructive-foreground: rgb(250, 250, 250);
  --border: rgb(64, 76, 122);
  --input: rgb(64, 76, 122);
  --ring: rgb(251, 191, 36);

  /* Modern browsers will override with OKLCH from index.css */
  --background: oklch(0.15 0.1 240);
  --foreground: oklch(0.98 0 0);
  --card: oklch(0.2 0.08 245);
  --card-foreground: oklch(0.98 0 0);
  --popover: oklch(0.2 0.08 245);
  --popover-foreground: oklch(0.98 0 0);
  --primary: oklch(0.75 0.15 85);
  --primary-foreground: oklch(0.15 0.1 240);
  --secondary: oklch(0.35 0.12 280);
  --secondary-foreground: oklch(0.98 0 0);
  --muted: oklch(0.25 0.06 250);
  --muted-foreground: oklch(0.7 0.02 240);
  --accent: oklch(0.85 0.18 90);
  --accent-foreground: oklch(0.15 0.1 240);
  --destructive: oklch(0.6 0.2 20);
  --destructive-foreground: oklch(0.98 0 0);
  --border: oklch(0.3 0.08 245);
  --input: oklch(0.3 0.08 245);
  --ring: oklch(0.85 0.18 90);
}

/* Fallback for browsers that don't support backdrop-filter */
@supports not (backdrop-filter: blur(10px)) {
  .backdrop-blur,
  .backdrop-blur-sm,
  .backdrop-blur-md,
  .backdrop-blur-lg,
  .backdrop-blur-xl {
    background-color: rgba(0, 0, 0, 0.5) !important;
  }
}

/* Disable complex animations on devices that prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Disable heavy blur effects on low-resolution displays */
@media (max-resolution: 1dppx) {
  .blur,
  .blur-sm,
  .blur-md,
  .blur-lg,
  .blur-xl,
  .blur-2xl,
  .blur-3xl {
    filter: none !important;
  }
}

/* Browser-specific fixes */
/* These classes are added via JavaScript feature detection */

/* Ensure blue boxes (cards) have solid fallback colors */
.no-oklch .bg-card {
  background-color: rgb(38, 46, 78) !important;
}

.no-oklch .bg-primary {
  background-color: rgb(234, 179, 8) !important;
}

.no-oklch .bg-accent {
  background-color: rgb(251, 191, 36) !important;
}

.no-oklch .text-primary {
  color: rgb(234, 179, 8) !important;
}

.no-oklch .text-accent {
  color: rgb(251, 191, 36) !important;
}

.no-oklch .border-primary {
  border-color: rgb(234, 179, 8) !important;
}

.no-oklch .border-accent {
  border-color: rgb(251, 191, 36) !important;
}

/* Fix for bg-fixed on mobile devices */
@media (max-width: 768px) {
  .bg-fixed {
    background-attachment: scroll !important;
  }
}
